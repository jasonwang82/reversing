# Claude for Excel & Claude for PowerPoint 产品文档

## 一、产品概述

### Claude for Excel

Claude for Excel（内部代号 **Pivot**）是 Anthropic 推出的 Microsoft Excel Office 插件，将 Claude AI 能力直接集成进 Excel 工作表。用户无需离开 Excel，即可通过自然语言完成数据分析、建模、格式化等复杂操作。

### Claude for PowerPoint

Claude for PowerPoint 是 Anthropic 推出的 Microsoft PowerPoint Office 插件，将 Claude AI 能力直接集成进演示文稿工作流。用户通过自然语言即可创建、编辑和美化 PPT，包括复杂图表、主题设计、版式调整等。

---

## 二、核心功能

### Claude for Excel

#### 读取工作表数据
| 功能 | 说明 |
|------|------|
| 读取单元格内容/公式/格式 | 支持按范围、按工作表读取，包含样式信息 |
| CSV 格式导出 | 适合 Python/pandas 数据处理 |
| 全表搜索 | 支持正则、大小写、完整匹配等多种搜索模式 |
| 获取对象列表 | 枚举数据透视表、图表等对象 |

#### 写入与修改工作表
| 功能 | 说明 |
|------|------|
| 写入值/公式/格式 | 支持字体、颜色、边框、数字格式等全量样式 |
| 清除内容/格式 | 可选择仅清除内容、仅清除格式或全清 |
| 复制范围（含公式翻译）| 复制并自动调整公式引用地址 |
| 插入/删除/隐藏行列 | 支持冻结窗格、取消冻结 |
| 工作表管理 | 创建/删除/重命名/复制工作表 |
| 调整行列尺寸 | 按点数或标准尺寸设置 |
| 创建/更新/删除图表和数据透视表 | 支持多种图表类型及透视配置 |

#### Python 代码执行（含 RPC）
- 在隔离的云端 Python 容器中运行 Python 代码（Debian 12，4 核 CPU，10 GB RAM）
- Python 代码可通过 RPC 机制直接读写用户本地 Excel 工作表
- 支持 pandas、numpy、scipy、openpyxl 等常用数据科学库
- 适合处理 **超过 1000 行**的大数据集

#### 网络搜索
- 搜索实时数据，用于补充金融数据、新闻等
- 针对金融数据，强制使用官方来源（SEC EDGAR、公司 IR 页面、官方新闻稿）
- 每个从网络获取的数据，写入时会自动附加来源注释

#### 金融建模规范
| 元素 | 格式规范 |
|------|----------|
| 蓝色字体 (#0000FF) | 硬编码输入/假设值 |
| 黑色字体 (#000000) | 所有公式与计算结果 |
| 绿色字体 (#008000) | 跨工作表链接 |
| 负数 | 括号格式：(123)，而非 -123 |
| 货币 | $#,##0，单位在表头中标注 |
| 百分比 | 0.0% 格式 |

#### 第三方金融数据终端支持
| 平台 | 函数示例 |
|------|----------|
| Bloomberg | `=BDP("AAPL US Equity", "PX_LAST")` |
| FactSet | `=FDS("AAPL-US", "P_PRICE")` |
| S&P Capital IQ | `=CIQ("NYSE:AAPL", "IQ_CLOSEPRICE")` |
| Refinitiv | `=TR("AAPL.O", "TR.CLOSEPRICE")` |

---

### Claude for PowerPoint

#### Office.js 直接操作
- 在插件内运行 JavaScript 代码，直接操控 PowerPoint 对象模型
- 支持新增、修改、删除幻灯片及其上的形状、文本、图片
- 支持版式（Layout）选择，自动继承主题样式

#### 幻灯片截图验证
- 对指定幻灯片截图，用于确认布局、位置、文本溢出、元素重叠等视觉问题

#### 图表编辑（OOXML）
- 通过原始 OOXML 操作幻灯片图表，支持柱形图、折线图、饼图等标准图表类型
- 不依赖 Office.js 的图表 API（Office.js 未暴露完整图表接口）

#### 幻灯片母版编辑
- 修改幻灯片母版与版式的 OOXML，批量设置主题颜色、字体、背景、装饰元素
- 一次设置，所有幻灯片自动继承

#### 幻灯片文本编辑
- 通过形状名称精确定位，修改指定形状中的文本段落（OOXML `<a:p>` 级别）
- 支持多形状同名时按出现顺序（occurrence）定位

#### 幻灯片复制
- 复制指定幻灯片并插入到目标位置（支持跨母版复制，自动清理冗余母版）

#### 幻灯片全局校验
- 检查所有幻灯片上的形状是否存在边界溢出（超出幻灯片边界）和相互重叠

#### 读取幻灯片文本
- 提取指定幻灯片上所有形状的文本内容，供 Claude 读取和理解现有内容

#### 网络搜索
- 搜索实时信息，辅助内容创作

---

## 三、主要使用场景

### Claude for Excel

1. **财务建模**：DCF 估值、预算模型、财务预测——Claude 会先询问澄清问题，再逐步构建
2. **大数据处理**：超过 1000 行的数据集，通过 Python 容器+RPC 高效批量处理
3. **数据清洗与转换**：使用 pandas 进行复杂的数据清洗、透视、聚合
4. **图表与透视表自动化**：一句话创建符合规范的图表或数据透视表
5. **实时数据整合**：从 SEC EDGAR、公司官网抓取数据，自动填入工作表并附来源注释

### Claude for PowerPoint

1. **从零创建演示文稿**：根据主题自动设计主题色、字体、背景，生成全套幻灯片
2. **内容扩充与润色**：在现有演示文稿中新增幻灯片，自动匹配已有风格
3. **图表创建**：将数据自动生成标准 OOXML 图表，嵌入幻灯片
4. **版式与布局优化**：自动拆分内容过多的幻灯片，保证字体不低于 14pt
5. **流程图/信息图制作**：通过 OOXML 精确控制形状位置和文字对齐，制作专业信息图

---

## 四、安全与隐私

### Claude for Excel

- **本地执行**：所有 Excel 操作通过 OfficeJS 在用户本地完成，Anthropic 无法直接访问用户的电子表格文件
- **沙箱隔离**：Python 代码运行在 gVisor 隔离的容器中，无网络访问权限，无法直接接触 Excel
- **覆盖保护**：`set_cell_range` 工具默认拒绝覆盖已有数据，需显式传入 `allow_overwrite: true`
- **操作审计**：每次 RPC 调用通过 `[TOOL_CALL]` 机制记录审计日志
- **编排器验证**：编排器（Orchestrator）对每个来自沙箱的工具调用请求进行验证，再转发给客户端执行

### Claude for PowerPoint

- **SES 沙箱**：LLM 生成的 Office.js 代码在 SES（Secure ECMAScript / Hardened JavaScript）Compartment 中执行
- **上下文代理**：`context` 对象被深度 Proxy 包装，追踪所有变更操作
- **权限提示**：在 `context.sync()` 时，向用户展示即将执行的操作列表，等待用户确认
- **外部引用过滤**：OOXML 导入前，自动检测并移除外部文件引用，防止注入攻击
- **超时保护**：工具执行超时限制为 90 秒，Office Online 环境下 `Office.run` 超时为 120 秒

---

## 五、用户交互设计

### Claude for Excel

- **渐进确认**：对于复杂任务（如 DCF 建模），Claude 会先提问澄清，再在关键里程碑处暂停等待用户确认
- **只读优先**：读取类工具可自由使用；写入类工具仅在用户明确要求时才执行
- **大数据预警**：超过 1000 行的数据集，Claude 自动切换到 Python 容器处理，避免直接在对话中操作

### Claude for PowerPoint

- **内容密度控制**：每张幻灯片最多 3-4 个要点，内容过多时自动拆分为多张幻灯片
- **字体最小限制**：任何元素字体不低于 14pt，正文推荐 16pt
- **视觉验证循环**：修改后自动截图验证，检查溢出和重叠，发现问题后自动修正
- **母版优先原则**：品牌元素、背景、装饰线条统一放在母版中，不在单张幻灯片上重复定义
