[
  {
    "type": "custom",
    "name": "get_cell_ranges",
    "description": "READ. Get detailed information about cells in specified ranges, including values, formulas, and key formatting. Accepts multiple ranges for efficient batch reading.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "number",
          "description": "The ID of the sheet to read from"
        },
        "ranges": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Array of A1 notation ranges (e.g., [\"A1:C10\", \"E1:F5\"])"
        },
        "includeStyles": {
          "default": true,
          "description": "Whether to include cell styles in the response (default: true)",
          "type": "boolean"
        },
        "cellLimit": {
          "default": 2000,
          "description": "Maximum number of non-empty cells to return (default: 2000). Ranges will be truncated at row boundaries to fit within this limit.",
          "type": "number"
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId",
        "ranges"
      ]
    },
    "allowed_callers": [
      "direct",
      "code_execution_20250825"
    ]
  },
  {
    "type": "custom",
    "name": "get_range_as_csv",
    "description": "READ. PREFERRED for code execution and data analysis. Returns CSV string ready for pandas. Use this by default when reading data in Python. Only use get_cell_ranges if you specifically need formulas, notes, or cell formatting.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "number",
          "description": "The ID of the sheet to read from"
        },
        "range": {
          "type": "string",
          "description": "A1 notation range to export as CSV (e.g., \"A1:Z100\", \"A:Z\")"
        },
        "includeHeaders": {
          "default": true,
          "description": "Whether the first row contains headers (default: true)",
          "type": "boolean"
        },
        "maxRows": {
          "default": 500,
          "description": "Maximum number of rows to return (default: 500). Use multiple calls with offset for larger datasets.",
          "type": "number"
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId",
        "range"
      ]
    },
    "allowed_callers": [
      "direct",
      "code_execution_20250825"
    ]
  },
  {
    "type": "custom",
    "name": "search_data",
    "description": "READ. Search for text across the spreadsheet and return matching cell locations. Results can be used with get_cell_ranges for detailed analysis.",
    "input_schema": {
      "type": "object",
      "properties": {
        "searchTerm": {
          "type": "string",
          "description": "The text to search for in the spreadsheet"
        },
        "sheetId": {
          "description": "Optional: Limit search to a specific sheet by its ID",
          "type": "number"
        },
        "range": {
          "description": "Optional: A1 notation range to limit search scope (e.g., \"A1:Z100\")",
          "type": "string"
        },
        "offset": {
          "description": "Number of results to skip for pagination (default: 0). Use nextOffset from previous response to get next page.",
          "type": "number"
        },
        "options": {
          "description": "Optional search configuration",
          "type": "object",
          "properties": {
            "matchCase": {
              "description": "Case-sensitive search (default: false)",
              "type": "boolean"
            },
            "matchEntireCell": {
              "description": "Match entire cell contents only (default: false)",
              "type": "boolean"
            },
            "useRegex": {
              "description": "Treat searchTerm as regular expression (default: false)",
              "type": "boolean"
            },
            "matchFormulas": {
              "description": "Search in formula text (default: false)",
              "type": "boolean"
            },
            "ignoreDiacritics": {
              "description": "Ignore accent marks (default: true)",
              "type": "boolean"
            },
            "maxResults": {
              "description": "Maximum number of results to return per page (default: 500)",
              "type": "number"
            }
          }
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "searchTerm"
      ]
    }
  },
  {
    "type": "custom",
    "name": "set_cell_range",
    "description": "WRITE. Set values, formulas, notes, and/or formatting for a range of cells. CRITICAL ARRAY DIMENSIONS: The cells array must EXACTLY match range dimensions to avoid InvalidCellRangeError. Calculate: range 'A1:D3' = 3 rows × 4 columns = [[r1c1,r1c2,r1c3,r1c4],[r2c1,r2c2,r2c3,r2c4],[r3c1,r3c2,r3c3,r3c4]]. Range 'A41:N48' = 8 rows × 14 columns = 8 arrays with 14 cells each. Single cell 'A1' = [[cell]]. Column range 'B5:B7' = [[cell1],[cell2],[cell3]]. Use {} for empty cells. Always provide a clear explanation parameter.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "number",
          "description": "The ID of the sheet to modify. You can get this from get_sheets_metadata. This parameter MUST be correct to avoid errors."
        },
        "range": {
          "type": "string",
          "description": "A1 notation range (e.g., \"A1:C10\"). Both start and end of the range are inclusive. The cells array must match the dimensions of this range."
        },
        "cells": {
          "description": "2D array that MUST exactly match range dimensions. EXAMPLES: Range 'A1:C2' (2×3) needs [[cell1,cell2,cell3],[cell4,cell5,cell6]]. Range 'A41:N48' (8×14) needs 8 arrays with 14 cells each. Range 'B5:B7' (3×1) needs [[cell1],[cell2],[cell3]]. Single cell 'A1' needs [[cell]]. COMMON ERRORS: Range 'A1:D3' with [[val1,val2]] is WRONG - needs 3 rows × 4 columns. Range 'A1:N8' with 8×1 array is WRONG - needs 8×14. Use {} for empty cells. Each cell can contain value, formula, note, cellStyles, and borderStyles.",
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "value": {
                  "description": "Static cell value (text, number, boolean). Do NOT put formulas here - use the 'formula' field instead"
                },
                "formula": {
                  "description": "Cell formula starting with '=' (e.g., '=SUM(A1:A10)'). Must use this field for formulas, not 'value'",
                  "type": "string"
                },
                "note": {
                  "description": "Cell note/comment",
                  "type": "string"
                },
                "cellStyles": {
                  "type": "object",
                  "properties": {
                    "fontColor": {
                      "description": "Font color (hex format like \"#000000\")",
                      "type": "string"
                    },
                    "fontSize": {
                      "description": "Font size in points (e.g., 10, 12, 14)",
                      "type": "number"
                    },
                    "fontFamily": {
                      "description": "Font family (e.g., \"Arial\", \"Roboto\", \"Times New Roman\")",
                      "type": "string"
                    },
                    "fontWeight": {
                      "description": "Font weight",
                      "type": "string",
                      "enum": [
                        "normal",
                        "bold"
                      ]
                    },
                    "fontStyle": {
                      "description": "Font style",
                      "type": "string",
                      "enum": [
                        "normal",
                        "italic"
                      ]
                    },
                    "fontLine": {
                      "description": "Font line style",
                      "type": "string",
                      "enum": [
                        "none",
                        "underline",
                        "line-through"
                      ]
                    },
                    "backgroundColor": {
                      "description": "Background color (hex format like \"#ffffff\")",
                      "type": "string"
                    },
                    "horizontalAlignment": {
                      "description": "Horizontal alignment",
                      "type": "string",
                      "enum": [
                        "left",
                        "center",
                        "right"
                      ]
                    },
                    "numberFormat": {
                      "description": "Number format (e.g., \"@\" for text, \"0.00\" for numbers, \"$#,##0.00\" for currency, \"mm/dd/yyyy\" for dates)",
                      "type": "string"
                    }
                  },
                  "description": "Cell styling properties including fonts, colors, alignment, and number formatting"
                },
                "borderStyles": {
                  "type": "object",
                  "properties": {
                    "top": {
                      "type": "object",
                      "properties": {
                        "style": {
                          "description": "Border line style",
                          "type": "string",
                          "enum": [
                            "solid",
                            "dashed",
                            "dotted",
                            "double"
                          ]
                        },
                        "weight": {
                          "description": "Border weight/thickness",
                          "type": "string",
                          "enum": [
                            "thin",
                            "medium",
                            "thick"
                          ]
                        },
                        "color": {
                          "description": "Border color (hex format like \"#000000\")",
                          "type": "string"
                        }
                      }
                    },
                    "bottom": {
                      "type": "object",
                      "properties": {
                        "style": {
                          "description": "Border line style",
                          "type": "string",
                          "enum": [
                            "solid",
                            "dashed",
                            "dotted",
                            "double"
                          ]
                        },
                        "weight": {
                          "description": "Border weight/thickness",
                          "type": "string",
                          "enum": [
                            "thin",
                            "medium",
                            "thick"
                          ]
                        },
                        "color": {
                          "description": "Border color (hex format like \"#000000\")",
                          "type": "string"
                        }
                      }
                    },
                    "left": {
                      "type": "object",
                      "properties": {
                        "style": {
                          "description": "Border line style",
                          "type": "string",
                          "enum": [
                            "solid",
                            "dashed",
                            "dotted",
                            "double"
                          ]
                        },
                        "weight": {
                          "description": "Border weight/thickness",
                          "type": "string",
                          "enum": [
                            "thin",
                            "medium",
                            "thick"
                          ]
                        },
                        "color": {
                          "description": "Border color (hex format like \"#000000\")",
                          "type": "string"
                        }
                      }
                    },
                    "right": {
                      "type": "object",
                      "properties": {
                        "style": {
                          "description": "Border line style",
                          "type": "string",
                          "enum": [
                            "solid",
                            "dashed",
                            "dotted",
                            "double"
                          ]
                        },
                        "weight": {
                          "description": "Border weight/thickness",
                          "type": "string",
                          "enum": [
                            "thin",
                            "medium",
                            "thick"
                          ]
                        },
                        "color": {
                          "description": "Border color (hex format like \"#000000\")",
                          "type": "string"
                        }
                      }
                    }
                  },
                  "description": "Border configuration for cells"
                }
              }
            }
          }
        },
        "copyToRange": {
          "description": "Optional A1 notation range to copy the cells to. WARNING: This copies VALUES, FORMULAS, AND FORMATTING - it will OVERWRITE existing data in the destination range. Do NOT use this to apply formatting to existing data. Use for: creating new rows with formulas, filling empty ranges. AUTOMATIC EXPANSION: Source A1:G1 can copy to A1:G100 - Excel will repeat the pattern and translate formulas (C2=B2 becomes C3=B3, C4=B4, etc).",
          "type": "string"
        },
        "resizeWidth": {
          "description": "Optional column width adjustment after setting values. Automatically applied to all columns in the range.",
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "points",
                "standard"
              ],
              "description": "Size method: points (numeric value), standard (reset to default)"
            },
            "value": {
              "description": "Size value in points (required for points type, ignored for standard)",
              "type": "number"
            }
          },
          "required": [
            "type"
          ]
        },
        "resizeHeight": {
          "description": "Optional row height adjustment after setting values. Automatically applied to all rows in the range.",
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "points",
                "standard"
              ],
              "description": "Size method: points (numeric value), standard (reset to default)"
            },
            "value": {
              "description": "Size value in points (required for points type, ignored for standard)",
              "type": "number"
            }
          },
          "required": [
            "type"
          ]
        },
        "allow_overwrite": {
          "description": "Set to true to allow overwriting existing cell data. If false or omitted, the tool will fail if any target cells contain values or formulas. Always set to true if you intend to modify existing data.",
          "type": "boolean"
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId",
        "range",
        "cells"
      ]
    },
    "allowed_callers": [
      "direct",
      "code_execution_20250825"
    ]
  },
  {
    "type": "custom",
    "name": "modify_sheet_structure",
    "description": "WRITE. Insert, delete, hide, unhide, or freeze rows/columns. PREFER this over set_cell_range for structural changes - it's a single fast operation that handles thousands of rows/columns instantly. Use for: adding/removing rows or columns, hiding data, freezing panes.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "integer",
          "minimum": -9007199254740991,
          "maximum": 9007199254740991,
          "description": "ID of the sheet to modify"
        },
        "operation": {
          "type": "string",
          "enum": [
            "insert",
            "delete",
            "hide",
            "unhide",
            "freeze",
            "unfreeze"
          ],
          "description": "Operation to perform: insert (requires dimension, reference, count, optional position), delete/hide/unhide (requires dimension, reference, count), freeze (requires dimension, count), unfreeze (no other parameters)"
        },
        "dimension": {
          "description": "What to modify: rows or columns. Required for all operations except unfreeze (which unfreezes both)",
          "type": "string",
          "enum": [
            "rows",
            "columns"
          ]
        },
        "reference": {
          "description": "Starting row number (e.g., '5') or column letter (e.g., 'C'). Required for insert/delete/hide/unhide operations. Not used for freeze/unfreeze.",
          "type": "string"
        },
        "position": {
          "description": "Position relative to reference (default: 'before'). Only used for insert operations",
          "type": "string",
          "enum": [
            "before",
            "after"
          ]
        },
        "count": {
          "description": "Number of rows/columns to operate on (default: 1). For delete 'A' count=3 means delete A:C. Required for freeze operations.",
          "type": "number",
          "minimum": 1
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId",
        "operation"
      ]
    }
  },
  {
    "type": "custom",
    "name": "modify_workbook_structure",
    "description": "WRITE. Create, delete, rename, or duplicate sheets in the spreadsheet workbook",
    "input_schema": {
      "type": "object",
      "properties": {
        "operation": {
          "type": "string",
          "enum": [
            "create",
            "delete",
            "rename",
            "duplicate"
          ],
          "description": "Operation to perform"
        },
        "sheetName": {
          "description": "Name for the new sheet (required for create)",
          "type": "string"
        },
        "rows": {
          "description": "Number of rows (default: 1000, only for create)",
          "type": "number"
        },
        "columns": {
          "description": "Number of columns (default: 26, only for create)",
          "type": "number"
        },
        "tabColor": {
          "description": "Tab color in hex format (only for create)",
          "type": "string"
        },
        "sheetId": {
          "description": "ID of the sheet (required for delete, rename, duplicate)",
          "type": "integer",
          "minimum": -9007199254740991,
          "maximum": 9007199254740991
        },
        "newName": {
          "description": "New name for the sheet (required for rename, optional for duplicate)",
          "type": "string"
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "operation"
      ]
    }
  },
  {
    "type": "custom",
    "name": "copy_to",
    "description": "WRITE. Copy a range to another location with automatic formula translation and pattern expansion. Excel will repeat source patterns to fill larger destinations and adjust relative references (C2=B2 becomes C3=B3). Perfect for financial models, loan schedules, data series. Example: Copy A12:G12 to A13:G370 to create 358 rows of formulas with auto-adjusted references.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "number",
          "description": "The ID of the sheet containing the ranges"
        },
        "sourceRange": {
          "type": "string",
          "description": "A1 notation range containing the source data/formulas to copy (e.g., 'A12:G12')"
        },
        "destinationRange": {
          "type": "string",
          "description": "A1 notation range to copy to (e.g., 'A13:G370'). Can be larger than source - pattern will repeat and formulas will auto-adjust (C12=B12 becomes C13=B13, C14=B14, etc)"
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId",
        "sourceRange",
        "destinationRange"
      ]
    }
  },
  {
    "type": "custom",
    "name": "get_all_objects",
    "description": "READ. Get all spreadsheet objects (pivot tables, charts, tables) from specified sheet or all sheets with their current configuration.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "description": "Optional sheet ID. If not provided, gets objects from all sheets",
          "type": "integer",
          "minimum": -9007199254740991,
          "maximum": 9007199254740991
        },
        "id": {
          "description": "Optional object ID to filter by (returns single object if found)",
          "type": "string"
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": []
    }
  },
  {
    "type": "custom",
    "name": "modify_object",
    "description": "WRITE. Create, update, or delete spreadsheet objects. Create: omit id, provide objectType and properties. Update: provide id and partial properties to change (LIMITATION: cannot update source range or destination location - you must delete and recreate for those changes). Delete: provide id only. IMPORTANT: When recreating objects, always delete the existing object FIRST to avoid range conflicts, then create the new one.",
    "input_schema": {
      "type": "object",
      "properties": {
        "operation": {
          "type": "string",
          "enum": [
            "create",
            "update",
            "delete"
          ],
          "description": "Operation to perform on the object"
        },
        "sheetId": {
          "type": "integer",
          "minimum": -9007199254740991,
          "maximum": 9007199254740991,
          "description": "Sheet ID where object is/will be located"
        },
        "id": {
          "description": "Object ID (required for update/delete, omit for create)",
          "type": "string"
        },
        "objectType": {
          "type": "string",
          "enum": [
            "pivotTable",
            "chart"
          ],
          "description": "Type of object to modify. You must specify this."
        },
        "properties": {
          "description": "Object properties to create/update. Provide fields relevant to the objectType.",
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "PivotTable name"
                },
                "range": {
                  "type": "string",
                  "description": "A1 notation of top-left cell where pivot table will be placed (e.g., 'F1')"
                },
                "source": {
                  "type": "string",
                  "description": "Range address to source data in format 'SheetName!StartCell:EndCell' (e.g., 'Sheet1!A1:D100')"
                },
                "rows": {
                  "description": "Fields to group by vertically",
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "field": {
                        "type": "string",
                        "description": "Field name from source data (OOXML field reference)"
                      }
                    },
                    "required": [
                      "field"
                    ]
                  }
                },
                "columns": {
                  "description": "Fields to group by horizontally",
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "field": {
                        "type": "string",
                        "description": "Field name from source data (OOXML field reference)"
                      }
                    },
                    "required": [
                      "field"
                    ]
                  }
                },
                "values": {
                  "minItems": 1,
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "field": {
                        "type": "string",
                        "description": "Field name from source data to aggregate"
                      },
                      "summarizeBy": {
                        "default": "sum",
                        "description": "Aggregation function (OOXML ST_DataConsolidateFunction)",
                        "type": "string",
                        "enum": [
                          "sum",
                          "count",
                          "average",
                          "max",
                          "min",
                          "product",
                          "countNums",
                          "stdDev",
                          "stdDevp",
                          "var",
                          "varp"
                        ]
                      }
                    },
                    "required": [
                      "field"
                    ]
                  },
                  "description": "Fields to aggregate (at least one required)"
                }
              },
              "additionalProperties": {}
            },
            {
              "type": "object",
              "properties": {
                "chartType": {
                  "type": "string",
                  "enum": [
                    "columnClustered",
                    "columnStacked",
                    "columnStacked100",
                    "column3D",
                    "barClustered",
                    "barStacked",
                    "barStacked100",
                    "bar3D",
                    "line",
                    "lineMarkers",
                    "lineStacked",
                    "lineStacked100",
                    "line3D",
                    "area",
                    "areaStacked",
                    "areaStacked100",
                    "area3D",
                    "pie",
                    "pieExploded",
                    "pie3D",
                    "doughnut",
                    "doughnutExploded",
                    "scatter",
                    "scatterLines",
                    "scatterLinesMarkers",
                    "radar",
                    "radarMarkers",
                    "radarFilled",
                    "bubble",
                    "stockHLC",
                    "stockOHLC",
                    "stockVHLC",
                    "stockVOHLC"
                  ],
                  "description": "Type of chart to create"
                },
                "title": {
                  "type": "string",
                  "description": "Chart UI display title"
                },
                "source": {
                  "description": "REQUIRED for create. OPTIONAL for update. Contiguous range address containing all chart data in format 'SheetName!A1:D100'. The range should have series organized in columns with headers in the first row, and category labels in the first column if applicable.",
                  "type": "string"
                },
                "anchor": {
                  "description": "A1 notation of top-left cell where chart will be anchored (e.g., 'F1'). Only used during create/update.",
                  "type": "string"
                },
                "position": {
                  "description": "Chart position in pt. Only returned when fetching existing charts.",
                  "type": "object",
                  "properties": {
                    "top": {
                      "type": "number",
                      "description": "Distance from top of worksheet in pt"
                    },
                    "left": {
                      "type": "number",
                      "description": "Distance from left of worksheet in pt"
                    }
                  },
                  "required": [
                    "top",
                    "left"
                  ]
                }
              },
              "additionalProperties": {}
            }
          ]
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "operation",
        "sheetId",
        "objectType"
      ]
    }
  },
  {
    "type": "custom",
    "name": "resize_range",
    "description": "WRITE. Resize columns and/or rows in a sheet. Supports specific sizes in point units or standard size reset. Can target specific ranges or entire sheet.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "number",
          "description": "The ID of the sheet to modify"
        },
        "range": {
          "description": "A1 notation range to resize (e.g., 'A:D' for columns, '1:5' for rows). If omitted, applies to entire sheet",
          "type": "string"
        },
        "width": {
          "description": "Column width settings",
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "points",
                "standard"
              ],
              "description": "Size method: points (numeric value), standard (reset to default)"
            },
            "value": {
              "description": "Size value in points (required for points type, ignored for standard)",
              "type": "number"
            }
          },
          "required": [
            "type"
          ]
        },
        "height": {
          "description": "Row height settings",
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "points",
                "standard"
              ],
              "description": "Size method: points (numeric value), standard (reset to default)"
            },
            "value": {
              "description": "Size value in points (required for points type, ignored for standard)",
              "type": "number"
            }
          },
          "required": [
            "type"
          ]
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId"
      ]
    }
  },
  {
    "type": "custom",
    "name": "clear_cell_range",
    "description": "WRITE. Clear cells in a range. By default clears only content (values/formulas) while preserving formatting. Use clearType='all' to remove both content and formatting, or clearType='formats' to remove only formatting.",
    "input_schema": {
      "type": "object",
      "properties": {
        "sheetId": {
          "type": "integer",
          "minimum": -9007199254740991,
          "maximum": 9007199254740991,
          "description": "ID of the sheet to clear cells from"
        },
        "range": {
          "type": "string",
          "description": "A1 notation range to clear (e.g., \"A1:C10\", \"B5\", \"D:D\", \"3:3\")"
        },
        "clearType": {
          "default": "contents",
          "description": "What to clear: 'all' (content + formatting), 'contents' (values/formulas only), 'formats' (formatting only)",
          "type": "string",
          "enum": [
            "all",
            "contents",
            "formats"
          ]
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "sheetId",
        "range"
      ]
    }
  },
  {
    "type": "custom",
    "name": "ask_user_question",
    "description": "Present tappable options to gather user preferences before starting work. This tool displays interactive options that users can tap to answer, which is faster and easier than typing.\n\nWHEN TO USE THIS TOOL:\nUse this for ELICITATION - when you need to understand the user's preferences, constraints, or goals before proceeding.\n\nExamples of when to USE this tool:\n- \"Build me a financial model\" → Ask about model type (DCF / 3-statement / LBO), time horizon (5-year / 10-year), whether they have assumptions or want standard ones\n- \"Help me analyze this data\" → Ask about analysis type (trends / comparisons / distributions), how to present results (summary / chart / pivot table)\n- \"Create a budget template\" → Ask about time granularity (monthly / quarterly / annual), department vs project-based\n- \"Clean up this spreadsheet\" → Ask about what to prioritize (formatting / data validation / structure / duplicates)\n\nCRITICAL: If you find yourself about to write clarifying questions with bullet points or numbered options in your response, STOP and use this tool instead. The questions you were going to write should become tappable options.\n\nWHEN NOT TO USE THIS TOOL:\n- User asks for your analysis or recommendation (e.g. \"Which formula should I use?\") → Give your perspective directly\n- Factual or how-to questions (e.g. \"How do I freeze panes?\") → Just answer\n- User needs prose feedback (e.g. \"Does this formula look right?\") → Provide written analysis\n- The question requires open-ended numeric input (e.g. \"What revenue to assume?\", \"What discount rate?\") → Ask in natural language\n\nAlways include a brief conversational message before presenting options - don't show options silently. Keep each question focused with 2-4 clear options.\n\nDo NOT include \"Other\" as one of the options — the UI already provides a free-text \"Something else\" input automatically.\n\nFor single-select questions, the response is a string. For multi-select, it's an array of strings.",
    "input_schema": {
      "type": "object",
      "properties": {
        "questions": {
          "minItems": 1,
          "maxItems": 4,
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "question": {
                "type": "string"
              },
              "header": {
                "type": "string"
              },
              "options": {
                "minItems": 2,
                "maxItems": 4,
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "label": {
                      "type": "string"
                    },
                    "description": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "label",
                    "description"
                  ]
                }
              },
              "multiSelect": {
                "type": "boolean"
              }
            },
            "required": [
              "question",
              "header",
              "options",
              "multiSelect"
            ]
          }
        }
      },
      "required": [
        "questions"
      ]
    }
  },
  {
    "type": "web_search_20250305",
    "name": "web_search"
  },
  {
    "type": "code_execution_20250825",
    "name": "code_execution"
  },
  {
    "type": "custom",
    "name": "execute_office_js",
    "description": "Execute Office.js JavaScript code to interact with the Excel document. The code receives a context parameter and runs inside Excel.run(). Use this for any document operations.",
    "input_schema": {
      "type": "object",
      "properties": {
        "code": {
          "type": "string",
          "description": "Async function body that receives 'context: Excel.RequestContext'. Must call context.sync() to execute batched operations and load() to read properties. Return JSON-serializable results."
        },
        "explanation": {
          "type": "string",
          "maxLength": 50,
          "description": "A very brief description of the action (max 50 chars). Shown next to the tool icon & permission prompts."
        }
      },
      "required": [
        "code"
      ]
    },
    "cache_control": {
      "type": "ephemeral"
    }
  }
]
